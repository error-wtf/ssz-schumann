# SSZ Formulas - Correct Mathematical Foundation

**Based on ssz-metric-pure and Segmented-Spacetime-Mass-Projection-Unified-Results**

© 2025 Carmen Wrede & Lino Casu

---

## Core SSZ Formulas (CORRECT)

### 1. Segment Density Field

**Exponential saturation model:**
```
Ξ(r) = Ξ_max · (1 - exp(-φ · r/r_s))
```

**Where:**
- Ξ_max = 1.0 (saturation value)
- φ = (1+√5)/2 ≈ 1.618034 (golden ratio)
- r_s = 2GM/c² (Schwarzschild radius)

**Properties:**
- Ξ(r) → 0 as r → 0 (no segments at center)
- Ξ(r) → Ξ_max as r → ∞ (saturates)
- φ in exponent ensures φ-based scaling

**Python:**
```python
def Xi_ssz(r, r_s, Xi_max=1.0):
    return Xi_max * (1 - np.exp(-PHI * r / r_s))
```

---

### 2. Time Dilation

**SSZ time dilation (relative to infinity):**
```
D_SSZ(r) = 1 / (1 + Ξ(r))
```

**Properties:**
- D_SSZ(0) = 1.0 (no time dilation at center!)
- D_SSZ(∞) → 0.5 (maximum time dilation)
- 0 < D_SSZ ≤ 1 always (NO SINGULARITY!)

**GR time dilation (Schwarzschild) for comparison:**
```
D_GR(r) = √(1 - r_s/r)
```

**Python:**
```python
def D_SSZ_from_Xi(Xi):
    return 1.0 / (1.0 + Xi)
```

---

### 3. Universal Intersection Point

**At r* = 1.386562 · r_s:**
```
D_SSZ(r*) = D_GR(r*) = 0.528007
Ξ(r*) = 0.893914
```

This intersection is **mass-independent** and marks the transition between GR and SSZ regimes.

---

### 4. Redshift

**SSZ gravitational redshift:**
```
z_SSZ = 1/D_SSZ - 1 = Ξ(r)
```

**GR gravitational redshift:**
```
z_GR = 1/D_GR - 1 = 1/√(1-r_s/r) - 1
```

---

## Application to Schumann Resonances

### Layered Model

For the Earth-ionosphere waveguide, we use a layered approach:

```
D_SSZ = 1 + Σ_j w_j · σ_j
```

where:
- j ∈ {ground, atmosphere, ionosphere}
- w_j = weight of layer j
- σ_j = effective segmentation parameter

**Default weights:**
- w_ground = 0.0 (hard boundary)
- w_atm = 0.2 (neutral layer)
- w_iono = 0.8 (main waveguide boundary)

### Frequency Correction

**SSZ-corrected Schumann frequency:**
```
f_n^(SSZ) = f_n^(classical) / D_SSZ
```

**Key SSZ signature:**
```
Δf_n / f_n = -δ_seg  (SAME for all modes!)
```

This uniform relative shift distinguishes SSZ from classical dispersive effects.

---

## Numerical Examples

### Example 1: Segment Density at r = r_s

```python
Xi = Xi_ssz(r_s, r_s)
   = 1 - exp(-φ)
   = 1 - exp(-1.618)
   ≈ 0.802
```

### Example 2: Time Dilation at r = r_s

```python
D_SSZ = 1 / (1 + 0.802)
      ≈ 0.555
```

Compare to GR: D_GR(r_s) = 0 (singularity!)

### Example 3: Schumann Frequency Shift

For 1% effective segmentation (δ_seg = 0.01):
```
D_SSZ = 1.01
f1_SSZ = 7.83 / 1.01 ≈ 7.75 Hz
Δf1 ≈ -0.08 Hz
```

---

## Key Differences from Previous Implementation

### WRONG (old):
```python
# INCORRECT - do not use!
D_SSZ = phi ** (-alpha * Xi)  # WRONG!
```

### CORRECT (new):
```python
# CORRECT formula from ssz-metric-pure
Xi = Xi_max * (1 - np.exp(-PHI * r / r_s))
D_SSZ = 1.0 / (1.0 + Xi)
```

---

## SSZ Detection Test Statistic (T_SSZ)

### Definition

The SSZ test statistic T_SSZ is defined as:

```
T_SSZ = w_corr · r_mean + w_scatter · (1 - scatter_ratio)
```

where:
- **r_mean** = mean pairwise correlation between δ_seg from different modes
- **scatter_ratio** = std(between modes) / mean(within mode std)
- **w_corr = 0.7** (default weight for correlation)
- **w_scatter = 0.3** (default weight for scatter)

### Interpretation

| T_SSZ | Interpretation |
|-------|----------------|
| > 0.7 | Strong SSZ signature |
| 0.5 - 0.7 | Moderate SSZ signature |
| 0.3 - 0.5 | Weak SSZ signature |
| < 0.3 | No SSZ signature |

### Null Hypothesis Testing

**H0:** No SSZ signal present (δ_seg variations are independent noise)

The null distribution is generated by:
1. **Shuffle method:** Randomly permute time indices independently per mode
2. **Phase randomization:** Randomize phases in Fourier domain
3. **Pure noise:** Generate Gaussian noise with same statistics

**P-value:** P(T_null ≥ T_observed)

---

## Eta Calibration Methods

### 1. Full Fit (Default)

Calibrate η₀ on full dataset:
```
η₀ = mean(f₁_obs) / f₁_ideal_factor
```

**Problem:** Any constant SSZ shift is absorbed into η₀.

### 2. Quiet Interval

Calibrate η₀ only on quiet period (first N days with δ_seg ≈ 0):
```
η₀ = mean(f₁_obs[quiet]) / f₁_ideal_factor
```

**Advantage:** Breaks the η₀/δ_seg degeneracy.

### 3. Fixed

Use theoretical/literature value:
```
η₀ = 0.74 (fixed)
```

### 4. Joint Fit

Simultaneously fit η₀ and δ_seg parameters:
```
minimize Σ_n,t (f_n^obs(t) - f_n^model(η₀, A, B, t))²
```

where:
```
f_n^model = f_n^classical(η₀) / (1 + A·basis₁(t) + B·basis₂(t))
```

**Advantage:** Optimal reconstruction with lowest bias.

---

## Basis Functions for δ_seg(t)

### Constant
```
δ_seg(t) = A
```

### Sinusoidal
```
δ_seg(t) = A · sin(2π·t/T + φ)
```

### F10.7 Linear
```
δ_seg(t) = A + B · (F10.7 - 100) / 100
```

### Combined
```
δ_seg(t) = A · sin(2π·t/T + φ) + B · (F10.7 - 100) / 100
```

---

## References

1. **ssz-metric-pure**: `src/ssz_metric_pure/segmentation.py`
2. **ssz-metric-pure**: `src/ssz_core/segment_density.py`
3. **Unified-Results**: `docs/MATHEMATICAL_FORMULAS.md`
4. **Unified-Results**: `run_ssz_validation.py`

---

**© 2025 Carmen Wrede & Lino Casu**
**Licensed under the Anti-Capitalist Software License v1.4**
